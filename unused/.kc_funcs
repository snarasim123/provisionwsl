#!/bin/bash

####
function find_pod(){
result=$(kubectl get pods | grep -i $1)
cnt=$(echo "$result" | wc -l )

podcount=$cnt
pod=$(echo "$result" | awk '{print$1}')
return 1
}

function find_pods(){
result=$(kubectl get pods | grep -i $1)
cnt=$(echo "$result" | wc -l )

podcount=$cnt
pods=$(echo "$result" | awk '{print$1}')
return 1
}

####
function kc_pod_shell(){
pod=""
podcount=0
#echo "Finding $1"
find_pod "$1"

if [[ $cnt -gt 1 ]] ; then
  echo "Found More than 1 pod."
  #echo "$result"
  pod=""
  podcount=$cnt
  return 1
fi
if [[ $cnt -eq 0 ]] ; then
  echo "Found 0 pod."
  pod=""
  podcount=$cnt
  return 1
fi

echo "Found pod = $pod"
kubectl exec -it $pod   -- /bin/bash
}

####
function kc_pod_find(){
pod=""
podcount=0
#echo "Finding $1"
find_pods "$1"

if [[ $cnt -gt 1 ]] ; then
  echo "Found More than 1 pod."
  #echo "$result"
  pods=""
  podcount=$cnt
  return 1
fi
if [[ $cnt -eq 0 ]] ; then
  echo "Found 0 pod."
  pods=""
  podcount=$cnt
  return 1
fi

echo "Found pods = $pods"
}

####
function kc_pod_log(){
pod=""
podcount=0
#echo "Finding $1"
find_pod "$1"

if [[ $cnt -gt 1 ]] ; then
  echo "Found More than 1 pod."
  #echo "$result"
  pod=""
  podcount=$cnt
  return 1
fi
if [[ $cnt -eq 0 ]] ; then
  echo "Found 0 pod."
  pod=""
  podcount=$cnt
  return 1
fi

echo "Logs for $pod ,"
kubectl logs $pod
}

####
function kc_pod_log_tail(){
pod=""
podcount=0
#echo "Finding $1"
find_pod "$1"

if [[ $cnt -gt 1 ]] ; then
  echo "Found More than 1 pod."
  #echo "$result"
  pod=""
  podcount=$cnt
  return 1
fi
if [[ $cnt -eq 0 ]] ; then
  echo "Found 0 pod."
  pod=""
  podcount=$cnt
  return 1
fi

echo "Logs for $pod ,"
kubectl logs $pod -f
}